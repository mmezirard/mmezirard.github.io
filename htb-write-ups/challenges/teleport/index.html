<!DOCTYPE html>
<html lang="en">
    <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
        <meta name="author" content="Matthieu Mezirard">
    
    <meta name="author" content="Matthieu Mezirard" />
    
        <meta name="description" content="This is a medium Reversing challenge.">
    
    <title>
        
            
        
        root@mmezirard:~&#x2F;htb-write-ups&#x2F;challenges&#x2F;teleport#
    </title>
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="stylesheet" type="text/css" href="/main.css" />
    <link
        id="theme-light-style"
        rel="stylesheet"
        type="text/css"
        href="/theme/light.css"
    />
    <link
        id="theme-dark-style"
        rel="stylesheet"
        type="text/css"
        href="/theme/dark.css"
    />
    <script
        async
        src="https://eu.umami.is/script.js"
        data-website-id="ab1b120c-cc97-47d0-bddb-d1a96cb06e5a"
    ></script>
    <script src="/js/theme-toggle.js"></script>
    <script src="/js/code-wrapper.js"></script>
    <script src="/js/code-indicator.js"></script>
</head>


    <body>
        <header>
    <div class="left">
        <a href="/">
    mmezirard
</a>

        <div class="socials">
    
        <a class="social" href="https:&#x2F;&#x2F;github.com&#x2F;mmezirard&#x2F;">
            <img src="/icons/github.svg" alt="github" />
        </a>
    
        <a class="social" href="https:&#x2F;&#x2F;app.hackthebox.com&#x2F;users&#x2F;1301891&#x2F;">
            <img src="/icons/hack-the-box.svg" alt="hack-the-box" />
        </a>
    
        <a class="social" href="https:&#x2F;&#x2F;hackerone.com&#x2F;mmezirard&#x2F;">
            <img src="/icons/hackerone.svg" alt="hackerone" />
        </a>
    
</div>

    </div>
    <div class="right">
        <nav>
    <ul>
        
            <li>
                <a href="&#x2F;htb-write-ups">
                    &#x2F;htb-write-ups
                </a>
            </li>
        
    </ul>
</nav>

        <button onclick="toggleTheme()">
    <img id="theme-toggle-sun" src="/icons/sun.svg" alt="Sun" />
    <img id="theme-toggle-moon" src="/icons/moon.svg" alt="Moon" />
</button>
<script src="/js/theme-toggle.js"></script>

    </div>
</header>

        
    <main>
        
<article>
    <div>
        
    
        <div class="page-h1">
            Teleport<span>.</span>
        </div>
    


        <div class="page-metadata">
            
                Posted on <time>2024-03-24</time>
            
        </div>

        
            <img
                class="page-cover"
                alt="cover.svg"
                src="https://mmezirard.github.io/htb-write-ups/challenges/teleport/cover.svg"
            />
        
    </div>

    
        <h1>Table of Contents</h1>
        <ul>
            
                <li>
                    <a href="https://mmezirard.github.io/htb-write-ups/challenges/teleport/#information">Information</a>
                    
                </li>
            
                <li>
                    <a href="https://mmezirard.github.io/htb-write-ups/challenges/teleport/#setup">Setup</a>
                    
                </li>
            
                <li>
                    <a href="https://mmezirard.github.io/htb-write-ups/challenges/teleport/#files">Files</a>
                    
                </li>
            
                <li>
                    <a href="https://mmezirard.github.io/htb-write-ups/challenges/teleport/#static-analysis">Static analysis</a>
                    
                        <ul>
                            
                                <li>
                                    <a href="https://mmezirard.github.io/htb-write-ups/challenges/teleport/#properties">Properties</a>
                                </li>

                                
                            
                                <li>
                                    <a href="https://mmezirard.github.io/htb-write-ups/challenges/teleport/#libraries">Libraries</a>
                                </li>

                                
                            
                                <li>
                                    <a href="https://mmezirard.github.io/htb-write-ups/challenges/teleport/#imports">Imports</a>
                                </li>

                                
                            
                                <li>
                                    <a href="https://mmezirard.github.io/htb-write-ups/challenges/teleport/#strings">Strings</a>
                                </li>

                                
                            
                        </ul>
                    
                </li>
            
                <li>
                    <a href="https://mmezirard.github.io/htb-write-ups/challenges/teleport/#dynamic-analysis">Dynamic analysis</a>
                    
                        <ul>
                            
                                <li>
                                    <a href="https://mmezirard.github.io/htb-write-ups/challenges/teleport/#execution">Execution</a>
                                </li>

                                
                            
                        </ul>
                    
                </li>
            
                <li>
                    <a href="https://mmezirard.github.io/htb-write-ups/challenges/teleport/#static-analysis-1">Static analysis</a>
                    
                        <ul>
                            
                                <li>
                                    <a href="https://mmezirard.github.io/htb-write-ups/challenges/teleport/#decompilation">Decompilation</a>
                                </li>

                                
                                    <ul>
                                        
                                            <li>
                                                <a href="https://mmezirard.github.io/htb-write-ups/challenges/teleport/#main">main</a>
                                            </li>
                                        
                                            <li>
                                                <a href="https://mmezirard.github.io/htb-write-ups/challenges/teleport/#checktwentythirdcharpassword">checkTwentyThirdCharPassword</a>
                                            </li>
                                        
                                            <li>
                                                <a href="https://mmezirard.github.io/htb-write-ups/challenges/teleport/#checkthirtyeighthcharpassword">checkThirtyEighthCharPassword</a>
                                            </li>
                                        
                                    </ul>
                                
                            
                        </ul>
                    
                </li>
            
                <li>
                    <a href="https://mmezirard.github.io/htb-write-ups/challenges/teleport/#putting-everything-together">Putting everything together</a>
                    
                </li>
            
                <li>
                    <a href="https://mmezirard.github.io/htb-write-ups/challenges/teleport/#afterwords">Afterwords</a>
                    
                </li>
            
        </ul>
    

    <section><h1 id="information">Information</h1>
<p><strong>Difficulty</strong>: Medium</p>
<p><strong>Category</strong>: Reversing</p>
<p><strong>Release date</strong>: 2022-05-27</p>
<p><strong>Created by</strong>: <a href="https://app.hackthebox.com/users/83743">clubby789</a></p>
<p><strong>Description</strong>: You've been sent to a strange planet, inhabited by a species
with the natural ability to teleport. If you're able to capture one, you may be
able to synthesise lightweight teleportation technology. However, they don't
want to be caught, and disappear out of your grasp - can you get the drop on
them?</p>
<h1 id="setup">Setup</h1>
<p>I'll complete this challenge using a Kali Linux VM. I'll create a <code>workspace</code>
directory at <code>/</code> to hold all the files related to this challenge, and the
commands ran on my machine will be prefixed with <code>❯</code> for clarity.</p>
<h1 id="files">Files</h1>
<pre data-lang="sh" class="language-sh z-code"><code class="language-sh" data-lang="sh"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">❯</span></span><span class="z-meta z-function-call z-arguments z-shell"> tree<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>a</span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">&quot;</span>/workspace<span class="z-punctuation z-definition z-string z-end z-shell">&quot;</span></span></span>
</span></code></pre>
<pre class="z-code"><code><span class="z-text z-plain">/workspace
</span><span class="z-text z-plain">└── rev_teleport
</span><span class="z-text z-plain">    └── teleport
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">&lt;SNIP&gt;
</span></code></pre>
<p>This challenge is comprised of a single file named <code>teleport</code>.</p>
<h1 id="static-analysis">Static analysis</h1>
<p>Let's start by statically analyzing the <code>teleport</code> file using the Rizin toolkit.</p>
<h2 id="properties">Properties</h2>
<p>Let's inspect the properties of this file.</p>
<pre data-lang="sh" class="language-sh z-code"><code class="language-sh" data-lang="sh"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">❯</span></span><span class="z-meta z-function-call z-arguments z-shell"> file <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">&quot;</span>/workspace/rev_teleport/teleport<span class="z-punctuation z-definition z-string z-end z-shell">&quot;</span></span></span>
</span></code></pre>
<pre class="z-code"><code><span class="z-text z-plain">teleport: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=1f87fe68fd7d1deaffefcf08ed2b30d660ee2d0b, stripped
</span></code></pre>
<p>This is an ELF 64-bit, LSB executable.</p>
<h2 id="libraries">Libraries</h2>
<p>Let's find out which libraries are used by this binary.</p>
<pre data-lang="sh" class="language-sh z-code"><code class="language-sh" data-lang="sh"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">❯</span></span><span class="z-meta z-function-call z-arguments z-shell"> rz-bin<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>l</span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">&quot;</span>/workspace/rev_teleport/teleport<span class="z-punctuation z-definition z-string z-end z-shell">&quot;</span></span></span>
</span></code></pre>
<pre class="z-code"><code><span class="z-text z-plain">[Libs]
</span><span class="z-text z-plain">library   
</span><span class="z-text z-plain">----------
</span><span class="z-text z-plain">libc.so.6
</span></code></pre>
<p>This binary uses the <code>libc.so.6</code> library, which provides the fundamental
functionalities for programs written in C.</p>
<h2 id="imports">Imports</h2>
<p>Now, let's find the list of objects imported by this binary.</p>
<pre data-lang="sh" class="language-sh z-code"><code class="language-sh" data-lang="sh"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">❯</span></span><span class="z-meta z-function-call z-arguments z-shell"> rz-bin<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>i</span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">&quot;</span>/workspace/rev_teleport/teleport<span class="z-punctuation z-definition z-string z-end z-shell">&quot;</span></span></span>
</span></code></pre>
<pre class="z-code"><code><span class="z-text z-plain">[Imports]
</span><span class="z-text z-plain">nth vaddr      bind   type   lib name                        
</span><span class="z-text z-plain">-------------------------------------------------------------
</span><span class="z-text z-plain">1   0x000009d0 GLOBAL FUNC       strncpy
</span><span class="z-text z-plain">2   ---------- WEAK   NOTYPE     _ITM_deregisterTMCloneTable
</span><span class="z-text z-plain">3   0x000009e0 GLOBAL FUNC       puts
</span><span class="z-text z-plain">4   ---------- GLOBAL FUNC       __libc_start_main
</span><span class="z-text z-plain">5   0x000009f0 GLOBAL FUNC       _setjmp
</span><span class="z-text z-plain">6   ---------- WEAK   NOTYPE     __gmon_start__
</span><span class="z-text z-plain">7   0x00000a00 GLOBAL FUNC       longjmp
</span><span class="z-text z-plain">8   ---------- WEAK   NOTYPE     _ITM_registerTMCloneTable
</span><span class="z-text z-plain">9   0x00000a10 WEAK   FUNC       __cxa_finalize
</span></code></pre>
<p>This binary imports functions like <code>puts</code>, but also <code>setjmp</code> and <code>longjmp</code> so we
can expect to see text printed to the terminal and jumps in the program.</p>
<h2 id="strings">Strings</h2>
<p>Finally, let's retrieve the list of strings contained in this binary.</p>
<pre data-lang="sh" class="language-sh z-code"><code class="language-sh" data-lang="sh"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">❯</span></span><span class="z-meta z-function-call z-arguments z-shell"> rz-bin<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>z</span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">&quot;</span>/workspace/rev_teleport/teleport<span class="z-punctuation z-definition z-string z-end z-shell">&quot;</span></span></span>
</span></code></pre>
<pre class="z-code"><code><span class="z-text z-plain">[Strings]
</span><span class="z-text z-plain">nth paddr      vaddr      len size section type  string               
</span><span class="z-text z-plain">----------------------------------------------------------------------
</span><span class="z-text z-plain">0   0x00001814 0x00001814 16  17   .rodata ascii Missing password
</span><span class="z-text z-plain">1   0x00001825 0x00001825 17  18   .rodata ascii Looks good to me!
</span><span class="z-text z-plain">2   0x00001837 0x00001837 20  21   .rodata ascii Something&#39;s wrong...
</span></code></pre>
<h1 id="dynamic-analysis">Dynamic analysis</h1>
<p>Now that we have an idea of what this binary could be doing, let's see what it
really does.</p>
<h2 id="execution">Execution</h2>
<p>Let's execute this binary on Linux.</p>
<pre data-lang="sh" class="language-sh z-code"><code class="language-sh" data-lang="sh"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">❯</span></span><span class="z-meta z-function-call z-arguments z-shell"> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">&quot;</span>/workspace/rev_teleport/teleport<span class="z-punctuation z-definition z-string z-end z-shell">&quot;</span></span></span>
</span></code></pre>
<pre class="z-code"><code><span class="z-text z-plain">Missing password
</span></code></pre>
<p>I assume that we have to provide a password as an argument to the program, so
let's enter a random one.</p>
<pre data-lang="sh" class="language-sh z-code"><code class="language-sh" data-lang="sh"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">❯</span></span><span class="z-meta z-function-call z-arguments z-shell"> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">&quot;</span>/workspace/rev_teleport/teleport<span class="z-punctuation z-definition z-string z-end z-shell">&quot;</span></span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">&quot;</span>hello?<span class="z-punctuation z-definition z-string z-end z-shell">&quot;</span></span></span>
</span></code></pre>
<pre class="z-code"><code><span class="z-text z-plain">Something&#39;s wrong...
</span></code></pre>
<h1 id="static-analysis-1">Static analysis</h1>
<h2 id="decompilation">Decompilation</h2>
<p>I'll load <code>teleport</code> with the default options using Binary Ninja.</p>
<p>As usual, I'll start by exploring the <code>main</code> function.</p>
<h3 id="main"><code>main</code></h3>
<pre data-lang="c" class="language-c z-code"><code class="language-c" data-lang="c"><span class="z-source z-c"><span class="z-storage z-type z-c">int</span> <span class="z-meta z-function z-c"><span class="z-entity z-name z-function z-c">main</span></span><span class="z-meta z-function z-parameters z-c"><span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-begin z-c">(</span></span></span><span class="z-meta z-function z-parameters z-c"><span class="z-meta z-group z-c"><span class="z-storage z-type z-c">int</span> <span class="z-variable z-parameter z-c">argc</span><span class="z-punctuation z-separator z-c">,</span> <span class="z-storage z-type z-c">char</span> <span class="z-keyword z-operator z-c">*</span><span class="z-keyword z-operator z-c">*</span><span class="z-variable z-parameter z-c">argv</span><span class="z-punctuation z-separator z-c">,</span> <span class="z-storage z-type z-c">char</span> <span class="z-keyword z-operator z-c">*</span><span class="z-keyword z-operator z-c">*</span><span class="z-variable z-parameter z-c">envp</span><span class="z-punctuation z-section z-group z-end z-c">)</span></span></span><span class="z-meta z-function z-c"> </span><span class="z-meta z-function z-c"><span class="z-meta z-block z-c"><span class="z-punctuation z-section z-block z-begin z-c">{</span></span></span><span class="z-meta z-function z-c"><span class="z-meta z-block z-c">
</span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c">
</span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c">    <span class="z-keyword z-control z-c">if</span> <span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-begin z-c">(</span>argc <span class="z-keyword z-operator z-comparison z-c">!=</span> <span class="z-constant z-numeric z-integer z-decimal z-c">2</span><span class="z-punctuation z-section z-group z-end z-c">)</span></span> <span class="z-meta z-block z-c"><span class="z-punctuation z-section z-block z-begin z-c">{</span>
</span></span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c"><span class="z-meta z-block z-c">        <span class="z-meta z-function-call z-c"><span class="z-support z-function z-C99 z-c">puts</span><span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-begin z-c">(</span></span></span><span class="z-meta z-function-call z-c"><span class="z-meta z-group z-c"><span class="z-string z-quoted z-double z-c"><span class="z-punctuation z-definition z-string z-begin z-c">&quot;</span>Missing password<span class="z-punctuation z-definition z-string z-end z-c">&quot;</span></span></span></span><span class="z-meta z-function-call z-c"><span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-end z-c">)</span></span></span><span class="z-punctuation z-terminator z-c">;</span>
</span></span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c"><span class="z-meta z-block z-c">        <span class="z-keyword z-control z-flow z-return z-c">return</span> EXIT_FAILURE<span class="z-punctuation z-terminator z-c">;</span>
</span></span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c"><span class="z-meta z-block z-c">    <span class="z-punctuation z-section z-block z-end z-c">}</span></span>
</span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c">
</span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c">    <span class="z-meta z-function-call z-c"><span class="z-support z-function z-C99 z-c">strncpy</span><span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-begin z-c">(</span></span></span><span class="z-meta z-function-call z-c"><span class="z-meta z-group z-c"><span class="z-keyword z-operator z-c">&amp;</span>firstCharPassword<span class="z-punctuation z-separator z-c">,</span> argv<span class="z-meta z-brackets z-c"><span class="z-punctuation z-section z-brackets z-begin z-c">[</span><span class="z-constant z-numeric z-integer z-decimal z-c">1</span><span class="z-punctuation z-section z-brackets z-end z-c">]</span></span><span class="z-punctuation z-separator z-c">,</span> <span class="z-constant z-numeric z-integer z-decimal z-c">100</span></span></span><span class="z-meta z-function-call z-c"><span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-end z-c">)</span></span></span><span class="z-punctuation z-terminator z-c">;</span>
</span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c">
</span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c">    <span class="z-keyword z-control z-c">for</span> <span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-begin z-c">(</span><span class="z-storage z-type z-c">int</span> i <span class="z-keyword z-operator z-assignment z-c">=</span> <span class="z-constant z-numeric z-integer z-decimal z-c">0</span><span class="z-punctuation z-terminator z-c">;</span> i <span class="z-keyword z-operator z-comparison z-c">&lt;=</span> <span class="z-constant z-numeric z-integer z-decimal z-c">42</span><span class="z-punctuation z-terminator z-c">;</span> i<span class="z-keyword z-operator z-arithmetic z-c">++</span><span class="z-punctuation z-section z-group z-end z-c">)</span></span> <span class="z-meta z-block z-c"><span class="z-punctuation z-section z-block z-begin z-c">{</span>
</span></span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c"><span class="z-meta z-block z-c">        <span class="z-keyword z-operator z-c">&amp;</span>checkTwentyThirdCharPasswordPtr<span class="z-meta z-brackets z-c"><span class="z-punctuation z-section z-brackets z-begin z-c">[</span>i<span class="z-punctuation z-section z-brackets z-end z-c">]</span></span><span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-begin z-c">(</span><span class="z-punctuation z-section z-group z-end z-c">)</span></span><span class="z-punctuation z-terminator z-c">;</span>
</span></span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c"><span class="z-meta z-block z-c">    <span class="z-punctuation z-section z-block z-end z-c">}</span></span>
</span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c">
</span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c">    <span class="z-storage z-type z-c">int</span> jmp_result <span class="z-keyword z-operator z-assignment z-c">=</span> <span class="z-meta z-function-call z-c"><span class="z-support z-function z-C99 z-c">setjmp</span><span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-begin z-c">(</span></span></span><span class="z-meta z-function-call z-c"><span class="z-meta z-group z-c"><span class="z-keyword z-operator z-c">&amp;</span>mainEnv</span></span><span class="z-meta z-function-call z-c"><span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-end z-c">)</span></span></span><span class="z-punctuation z-terminator z-c">;</span>
</span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c">
</span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c">    <span class="z-keyword z-control z-c">if</span> <span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-begin z-c">(</span>jmp_result <span class="z-keyword z-operator z-comparison z-c">==</span> <span class="z-constant z-numeric z-integer z-decimal z-c">100</span><span class="z-punctuation z-section z-group z-end z-c">)</span></span> <span class="z-meta z-block z-c"><span class="z-punctuation z-section z-block z-begin z-c">{</span>
</span></span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c"><span class="z-meta z-block z-c">        <span class="z-meta z-function-call z-c"><span class="z-support z-function z-C99 z-c">puts</span><span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-begin z-c">(</span></span></span><span class="z-meta z-function-call z-c"><span class="z-meta z-group z-c"><span class="z-string z-quoted z-double z-c"><span class="z-punctuation z-definition z-string z-begin z-c">&quot;</span>Looks good to me!<span class="z-punctuation z-definition z-string z-end z-c">&quot;</span></span></span></span><span class="z-meta z-function-call z-c"><span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-end z-c">)</span></span></span><span class="z-punctuation z-terminator z-c">;</span>
</span></span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c"><span class="z-meta z-block z-c">    <span class="z-punctuation z-section z-block z-end z-c">}</span></span> <span class="z-keyword z-control z-c">else</span> <span class="z-meta z-block z-c"><span class="z-punctuation z-section z-block z-begin z-c">{</span>
</span></span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c"><span class="z-meta z-block z-c">        <span class="z-keyword z-control z-c">if</span> <span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-begin z-c">(</span>jmp_result <span class="z-keyword z-operator z-comparison z-c">!=</span> <span class="z-constant z-numeric z-integer z-decimal z-c">101</span><span class="z-punctuation z-section z-group z-end z-c">)</span></span> <span class="z-meta z-block z-c"><span class="z-punctuation z-section z-block z-begin z-c">{</span>
</span></span></span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c"><span class="z-meta z-block z-c"><span class="z-meta z-block z-c">            <span class="z-meta z-function-call z-c"><span class="z-support z-function z-C99 z-c">longjmp</span><span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-begin z-c">(</span></span></span><span class="z-meta z-function-call z-c"><span class="z-meta z-group z-c"><span class="z-keyword z-operator z-c">&amp;</span>checkFirstCharPasswordEnv <span class="z-keyword z-operator z-arithmetic z-c">+</span> <span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-begin z-c">(</span>jmp_result <span class="z-keyword z-operator z-c">*</span> <span class="z-constant z-numeric z-integer z-decimal z-c">200</span><span class="z-punctuation z-section z-group z-end z-c">)</span></span><span class="z-punctuation z-separator z-c">,</span> <span class="z-constant z-numeric z-integer z-decimal z-c">1</span></span></span><span class="z-meta z-function-call z-c"><span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-end z-c">)</span></span></span><span class="z-punctuation z-terminator z-c">;</span>
</span></span></span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c"><span class="z-meta z-block z-c"><span class="z-meta z-block z-c">        <span class="z-punctuation z-section z-block z-end z-c">}</span></span>
</span></span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c"><span class="z-meta z-block z-c">        <span class="z-meta z-function-call z-c"><span class="z-support z-function z-C99 z-c">puts</span><span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-begin z-c">(</span></span></span><span class="z-meta z-function-call z-c"><span class="z-meta z-group z-c"><span class="z-string z-quoted z-double z-c"><span class="z-punctuation z-definition z-string z-begin z-c">&quot;</span>Something&#39;s wrong...<span class="z-punctuation z-definition z-string z-end z-c">&quot;</span></span></span></span><span class="z-meta z-function-call z-c"><span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-end z-c">)</span></span></span><span class="z-punctuation z-terminator z-c">;</span>
</span></span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c"><span class="z-meta z-block z-c">    <span class="z-punctuation z-section z-block z-end z-c">}</span></span>
</span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c">
</span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c">    <span class="z-keyword z-control z-flow z-return z-c">return</span> <span class="z-constant z-numeric z-integer z-decimal z-c">0</span><span class="z-punctuation z-terminator z-c">;</span>
</span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c"></span></span><span class="z-meta z-function z-c"><span class="z-meta z-block z-c"><span class="z-punctuation z-section z-block z-end z-c">}</span></span></span>
</span></code></pre>
<p>This program asks the user for input, and saves it in <code>firstCharPassword</code>.</p>
<p>The <code>firstCharPassword</code> symbol is defined in the <code>.bss</code> section of the binary:</p>
<pre class="z-code"><code><span class="z-text z-plain">00000000: char firstCharPassword = 0x0
</span><span class="z-text z-plain">00000000: char secondCharPassword = 0x0
</span><span class="z-text z-plain">00000000: char thirdCharPassword = 0x0
</span><span class="z-text z-plain">00000000: char fourthCharPassword = 0x0
</span><span class="z-text z-plain">00000000: char fifthCharPassword = 0x0
</span><span class="z-text z-plain">00000000: char sixthCharPassword = 0x0
</span><span class="z-text z-plain">00000000: char seventhCharPassword = 0x0
</span><span class="z-text z-plain">00000000: char eighthCharPassword = 0x0
</span><span class="z-text z-plain">00000000: char ninthCharPassword = 0x0
</span><span class="z-text z-plain">00000000: char tenthCharPassword = 0x0
</span><span class="z-text z-plain">00000000: char eleventhCharPassword = 0x0
</span><span class="z-text z-plain">00000000: char twelfthCharPassword = 0x0
</span><span class="z-text z-plain">00000000: char thirteenthCharPassword = 0x0
</span><span class="z-text z-plain">00000000: char fourtheenthCharPassword = 0x0
</span><span class="z-text z-plain">00000000: char fifteenthCharPassword = 0x0
</span><span class="z-text z-plain">00000000: char sixteenthCharPassword = 0x0
</span><span class="z-text z-plain">00000010: char seventeenthCharPassword = 0x0
</span><span class="z-text z-plain">00000010: char eighteenthCharPassword = 0x0
</span><span class="z-text z-plain">00000010: char nineteenthCharPassword = 0x0
</span><span class="z-text z-plain">00000010: char twentiethCharPassword = 0x0
</span><span class="z-text z-plain">00000010: char twentyFirstCharPassword = 0x0
</span><span class="z-text z-plain">00000010: char twentySecondCharPassword = 0x0
</span><span class="z-text z-plain">00000010: char twentyThirdCharPassword = 0x0
</span><span class="z-text z-plain">00000010: char twentyFourthCharPassword = 0x0
</span><span class="z-text z-plain">00000010: char twentyFifthCharPassword = 0x0
</span><span class="z-text z-plain">00000010: char twentySixthCharPassword = 0x0
</span><span class="z-text z-plain">00000010: char twentySeventhCharPassword = 0x0
</span><span class="z-text z-plain">00000010: char twentyEighthCharPassword = 0x0
</span><span class="z-text z-plain">00000010: char twentyNinthCharPassword = 0x0
</span><span class="z-text z-plain">00000010: char thirtiethCharPassword = 0x0
</span><span class="z-text z-plain">00000010: char thirtyFirstCharPassword = 0x0
</span><span class="z-text z-plain">00000010: char thirtySecondCharPassword = 0x0
</span><span class="z-text z-plain">00000020: char thirtyThirdCharPassword = 0x0
</span><span class="z-text z-plain">00000020: char thirtyFourthCharPassword = 0x0
</span><span class="z-text z-plain">00000020: char thirtyFifthCharPassword = 0x0
</span><span class="z-text z-plain">00000020: char thirtySixthCharPassword = 0x0
</span><span class="z-text z-plain">00000020: char thirtySeventhCharPassword = 0x0
</span><span class="z-text z-plain">00000020: char thirtyEighthCharPassword = 0x0
</span><span class="z-text z-plain">00000020: char thirtyNinthCharPassword = 0x0
</span><span class="z-text z-plain">00000020: char fortiethCharPassword = 0x0
</span><span class="z-text z-plain">00000020: char fortyFirstCharPassword = 0x0
</span><span class="z-text z-plain">00000020: char fortySecondCharPassword = 0x0
</span><span class="z-text z-plain">00000020: char fortyThirdCharPassword = 0x0
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">00000020:                                  00 00 00 00 00             .....
</span><span class="z-text z-plain">00000030: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00000040: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00000050: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00000060: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00000070: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00000080: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span></code></pre>
<p>The first 43 characters of the password we give to the program are actually
assigned to global variables.</p>
<p>Then, the program executes the <code>checkTwentyThirdCharPasswordPtr[i]</code> function,
where <code>i</code> varies between <code>0</code> and <code>42</code>.</p>
<p>The <code>checkTwentyThirdCharPasswordPtr</code> symbol is defined in the <code>.data</code> section
of the binary:</p>
<pre class="z-code"><code><span class="z-text z-plain">00000000: void* checkTwentyThirdCharPasswordPtr = checkTwentyThirdCharPassword
</span><span class="z-text z-plain">00000000: void* checkThirtyEighthCharPasswordPtr = checkThirtyEighthCharPassword
</span><span class="z-text z-plain">00000010: void* checkSecondCharPasswordPtr = checkSecondCharPassword
</span><span class="z-text z-plain">00000010: void* checkThirtySecondCharPasswordPtr = checkThirtySecondCharPassword
</span><span class="z-text z-plain">00000020: void* checkFortyFirstCharPasswordPtr = checkFortyFirstCharPassword
</span><span class="z-text z-plain">00000020: void* checkTwentiethCharPasswordPtr = checkTwentiethCharPassword
</span><span class="z-text z-plain">00000030: void* checkThirtySixthCharPasswordPtr = checkThirtySixthCharPassword
</span><span class="z-text z-plain">00000030: void* checkThirtySeventhCharPasswordPtr = checkThirtySeventhCharPassword
</span><span class="z-text z-plain">00000040: void* checkThirtyThirdCharPasswordPtr = checkThirtyThirdCharPassword
</span><span class="z-text z-plain">00000040: void* checkFifthCharPasswordPtr = checkFifthCharPassword
</span><span class="z-text z-plain">00000050: void* checkSeventhCharPasswordPtr = checkSeventhCharPassword
</span><span class="z-text z-plain">00000050: void* checkTwentySixthCharPasswordPtr = checkTwentySixthCharPassword
</span><span class="z-text z-plain">00000060: void* checkFourthCharPasswordPtr = checkFourthCharPassword
</span><span class="z-text z-plain">00000060: void* checkEighteenthCharPasswordPtr = checkEighteenthCharPassword
</span><span class="z-text z-plain">00000070: void* checkTenthCharPasswordPtr = checkTenthCharPassword
</span><span class="z-text z-plain">00000070: void* checkTwentyEighthCharPasswordPtr = checkTwentyEighthCharPassword
</span><span class="z-text z-plain">00000080: void* checkThirtyFifthCharPasswordPtr = checkThirtyFifthCharPassword
</span><span class="z-text z-plain">00000080: void* checkThirtyFourthCharPasswordPtr = checkThirtyFourthCharPassword
</span><span class="z-text z-plain">00000090: void* checkThirtyFirstCharPasswordPtr = checkThirtyFirstCharPassword
</span><span class="z-text z-plain">00000090: void* checkTwentyFourthCharPasswordPtr = checkTwentyFourthCharPassword
</span><span class="z-text z-plain">000000a0: void* checkSixteenthCharPasswordPtr = checkSixteenthCharPassword
</span><span class="z-text z-plain">000000a0: void* checkThirtiethCharPasswordPtr = checkThirtiethCharPassword
</span><span class="z-text z-plain">000000b0: void* checkFortySecondCharPasswordPtr = checkFortySecondCharPassword
</span><span class="z-text z-plain">000000b0: void* checkFortyThirdCharPasswordPtr = checkFortyThirdCharPassword
</span><span class="z-text z-plain">000000c0: void* checkSixthCharPasswordPtr = checkSixthCharPassword
</span><span class="z-text z-plain">000000c0: void* checkThirdCharPasswordPtr = checkThirdCharPassword
</span><span class="z-text z-plain">000000d0: void* checkFourtheenthCharPasswordPtr = checkFourtheenthCharPassword
</span><span class="z-text z-plain">000000d0: void* checkFortiethCharPasswordPtr = checkFortiethCharPassword
</span><span class="z-text z-plain">000000e0: void* checkEighthCharPasswordPtr = checkEighthCharPassword
</span><span class="z-text z-plain">000000e0: void* checkTwelfthCharPasswordPtr = checkTwelfthCharPassword
</span><span class="z-text z-plain">000000f0: void* checkTwentySecondCharPasswordPtr = checkTwentySecondCharPassword
</span><span class="z-text z-plain">000000f0: void* checkFirstCharPasswordPtr = checkFirstCharPassword
</span><span class="z-text z-plain">00000100: void* checkTwentyFirstCharPasswordPtr = checkTwentyFirstCharPassword
</span><span class="z-text z-plain">00000100: void* nineteenthCharPasswordPtr = checkNineteenthCharPassword
</span><span class="z-text z-plain">00000110: void* checkSeventeenthCharPasswordPtr = checkSeventeenthCharPassword
</span><span class="z-text z-plain">00000110: void* checkFifteenthCharPasswordPtr = checkFifteenthCharPassword
</span><span class="z-text z-plain">00000120: void* checkThirteenthCharPasswordPtr = checkThirteenthCharPassword
</span><span class="z-text z-plain">00000120: void* checkNinthCharPasswordPtr = checkNinthCharPassword
</span><span class="z-text z-plain">00000130: void* checkEleventhCharPasswordPtr = checkEleventhCharPassword
</span><span class="z-text z-plain">00000130: void* checkTwentySeventhCharPasswordPtr = checkTwentySeventhCharPassword
</span><span class="z-text z-plain">00000140: void* checkTwentyFifthCharPasswordPtr = checkTwentyFifthCharPassword
</span><span class="z-text z-plain">00000140: void* checkThirtyNinthCharPasswordPtr = checkThirtyNinthCharPassword
</span><span class="z-text z-plain">00000150: void* checkTwentyNinthCharPasswordPtr = checkTwentyNinthCharPassword
</span></code></pre>
<p>This means that all of these functions are executed by the loop.</p>
<p>Then, this function calls <code>setjmp</code> with the <code>mainEnv</code> symbol, defined in <code>.bss</code>:</p>
<pre class="z-code"><code><span class="z-text z-plain">00000000: mainEnv:
</span><span class="z-text z-plain">00000000: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00000010: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00000020: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00000030: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00000040: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00000050: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00000060: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00000070: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00000080: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00000090: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">000000a0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">000000b0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">000000c0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">000000d0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span></code></pre>
<p>This effectively stores the <code>main</code> function context at this address.</p>
<p>The <code>jmp_result</code> is then compared to values. If it's <code>100</code>, it's a success, and
if it's <code>101</code>, it's a failure.</p>
<p>If it's neither <code>100</code> nor <code>101</code>, it calls <code>longjmp</code> with the
<code>checkFirstCharPasswordEnv</code> symbol, plus an offset. This symbol is also defined
in the <code>.bss</code> segment:</p>
<pre class="z-code"><code><span class="z-text z-plain">00000000  checkFirstCharPasswordEnv:
</span><span class="z-text z-plain">00000000  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00000010  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00000020  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00000030  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00000040  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00000050  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00000060  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00000070  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00000080  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00000090  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">000000a0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">000000b0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">000000c0  00 00 00 00 00 00 00 00                          ........
</span><span class="z-text z-plain">000000c0  checkSecondCharPasswordEnv:
</span><span class="z-text z-plain">000000c0                          00 00 00 00 00 00 00 00          ........
</span><span class="z-text z-plain">000000d0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">000000e0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">000000f0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00000100  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00000110  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00000120  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00000130  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00000140  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00000150  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00000160  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00000170  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00000180  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00000190  checkThirdCharPasswordEnv:
</span><span class="z-text z-plain">00000190  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">000001a0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">000001b0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">000001c0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">000001d0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">000001e0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">000001f0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00000200  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00000210  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00000220  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00000230  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00000240  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00000250  00 00 00 00 00 00 00 00                          ........
</span><span class="z-text z-plain">&lt;SNIP&gt;
</span><span class="z-text z-plain">000020d0  checkFortyThirdCharPasswordEnv:
</span><span class="z-text z-plain">000020d0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">000020e0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">000020f0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00002100: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00002110: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00002120: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00002130: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00002140: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00002150: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00002160: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00002170: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00002180: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00002190: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">000021a0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">000021b0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">000021c0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">000021d0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">000021e0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">000021f0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00002200: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00002210: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00002220: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00002230: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00002240: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span><span class="z-text z-plain">00002250: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span></code></pre>
<p>In fact, there's 43 global variables next to each other, which are meant to
store the context for the 43 functions we discovered previously.</p>
<h3 id="checktwentythirdcharpassword"><code>checkTwentyThirdCharPassword</code></h3>
<pre data-lang="c" class="language-c z-code"><code class="language-c" data-lang="c"><span class="z-source z-c"><span class="z-storage z-type z-c">long</span> <span class="z-storage z-type z-c">long</span> <span class="z-storage z-type z-c">int</span> <span class="z-meta z-function z-c"><span class="z-entity z-name z-function z-c">checkTwentyThirdCharPassword</span></span><span class="z-meta z-function z-parameters z-c"><span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-begin z-c">(</span></span></span><span class="z-meta z-function z-parameters z-c"><span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-end z-c">)</span></span></span><span class="z-meta z-function z-c"> </span><span class="z-meta z-function z-c"><span class="z-meta z-block z-c"><span class="z-punctuation z-section z-block z-begin z-c">{</span></span></span><span class="z-meta z-function z-c"><span class="z-meta z-block z-c">
</span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c">    <span class="z-storage z-type z-c">int</span> jmp_result <span class="z-keyword z-operator z-assignment z-c">=</span> <span class="z-meta z-function-call z-c"><span class="z-support z-function z-C99 z-c">setjmp</span><span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-begin z-c">(</span></span></span><span class="z-meta z-function-call z-c"><span class="z-meta z-group z-c"><span class="z-keyword z-operator z-c">&amp;</span>checkTwentyThirdCharPasswordEnv</span></span><span class="z-meta z-function-call z-c"><span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-end z-c">)</span></span></span><span class="z-punctuation z-terminator z-c">;</span>
</span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c">    <span class="z-keyword z-control z-c">if</span> <span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-begin z-c">(</span>jmp_result <span class="z-keyword z-operator z-comparison z-c">==</span> <span class="z-constant z-numeric z-integer z-decimal z-c">0</span><span class="z-punctuation z-section z-group z-end z-c">)</span></span> <span class="z-meta z-block z-c"><span class="z-punctuation z-section z-block z-begin z-c">{</span>
</span></span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c"><span class="z-meta z-block z-c">        <span class="z-keyword z-control z-flow z-return z-c">return</span> jmp_result<span class="z-punctuation z-terminator z-c">;</span>
</span></span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c"><span class="z-meta z-block z-c">    <span class="z-punctuation z-section z-block z-end z-c">}</span></span>
</span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c">
</span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c">    <span class="z-keyword z-control z-c">if</span> <span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-begin z-c">(</span>twentyThirdCharPassword <span class="z-keyword z-operator z-comparison z-c">!=</span> <span class="z-string z-quoted z-single z-c"><span class="z-punctuation z-definition z-string z-begin z-c">&#39;</span>p<span class="z-punctuation z-definition z-string z-end z-c">&#39;</span></span><span class="z-punctuation z-section z-group z-end z-c">)</span></span> <span class="z-meta z-block z-c"><span class="z-punctuation z-section z-block z-begin z-c">{</span>
</span></span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c"><span class="z-meta z-block z-c">        <span class="z-meta z-function-call z-c"><span class="z-support z-function z-C99 z-c">longjmp</span><span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-begin z-c">(</span></span></span><span class="z-meta z-function-call z-c"><span class="z-meta z-group z-c"><span class="z-keyword z-operator z-c">&amp;</span>mainEnv<span class="z-punctuation z-separator z-c">,</span> <span class="z-constant z-numeric z-integer z-decimal z-c">101</span></span></span><span class="z-meta z-function-call z-c"><span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-end z-c">)</span></span></span><span class="z-punctuation z-terminator z-c">;</span>
</span></span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c"><span class="z-meta z-block z-c">    <span class="z-punctuation z-section z-block z-end z-c">}</span></span>
</span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c">    <span class="z-meta z-function-call z-c"><span class="z-support z-function z-C99 z-c">longjmp</span><span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-begin z-c">(</span></span></span><span class="z-meta z-function-call z-c"><span class="z-meta z-group z-c"><span class="z-keyword z-operator z-c">&amp;</span>mainEnv<span class="z-punctuation z-separator z-c">,</span> <span class="z-constant z-numeric z-integer z-decimal z-c">23</span></span></span><span class="z-meta z-function-call z-c"><span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-end z-c">)</span></span></span><span class="z-punctuation z-terminator z-c">;</span>
</span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c"></span></span><span class="z-meta z-function z-c"><span class="z-meta z-block z-c"><span class="z-punctuation z-section z-block z-end z-c">}</span></span></span>
</span></code></pre>
<p>This function checks if <code>twentyThirdCharPassword</code> is equal to the character <code>p</code>.
Depending on the result, it jumps to the <code>main</code> function context either with a
value of <code>101</code>, which indicates an error, or a value of <code>23</code>, which is the
offset of the context for the next character check from the <code>checkFirstCharEnv</code>
context.</p>
<p>Note that this function isn't entirely executed the first time it gets called,
since <code>jmp_result</code> is then equal to <code>0</code>. The first execution only sets up the
context in the global variable <code>checkTwentyThirdCharPasswordEnv</code>.</p>
<h3 id="checkthirtyeighthcharpassword"><code>checkThirtyEighthCharPassword</code></h3>
<pre data-lang="c" class="language-c z-code"><code class="language-c" data-lang="c"><span class="z-source z-c"><span class="z-storage z-type z-c">long</span> <span class="z-storage z-type z-c">long</span> <span class="z-storage z-type z-c">int</span> <span class="z-meta z-function z-c"><span class="z-entity z-name z-function z-c">checkThirtyEighthCharPassword</span></span><span class="z-meta z-function z-parameters z-c"><span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-begin z-c">(</span></span></span><span class="z-meta z-function z-parameters z-c"><span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-end z-c">)</span></span></span><span class="z-meta z-function z-c"> </span><span class="z-meta z-function z-c"><span class="z-meta z-block z-c"><span class="z-punctuation z-section z-block z-begin z-c">{</span></span></span><span class="z-meta z-function z-c"><span class="z-meta z-block z-c">
</span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c">    <span class="z-storage z-type z-c">int</span> jmp_result <span class="z-keyword z-operator z-assignment z-c">=</span> <span class="z-meta z-function-call z-c"><span class="z-support z-function z-C99 z-c">setjmp</span><span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-begin z-c">(</span></span></span><span class="z-meta z-function-call z-c"><span class="z-meta z-group z-c"><span class="z-keyword z-operator z-c">&amp;</span>checkThirtyEighthCharPasswordEnv</span></span><span class="z-meta z-function-call z-c"><span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-end z-c">)</span></span></span><span class="z-punctuation z-terminator z-c">;</span>
</span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c">    <span class="z-keyword z-control z-c">if</span> <span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-begin z-c">(</span>jmp_result <span class="z-keyword z-operator z-comparison z-c">==</span> <span class="z-constant z-numeric z-integer z-decimal z-c">0</span><span class="z-punctuation z-section z-group z-end z-c">)</span></span> <span class="z-meta z-block z-c"><span class="z-punctuation z-section z-block z-begin z-c">{</span>
</span></span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c"><span class="z-meta z-block z-c">        <span class="z-keyword z-control z-flow z-return z-c">return</span> jmp_result<span class="z-punctuation z-terminator z-c">;</span>
</span></span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c"><span class="z-meta z-block z-c">    <span class="z-punctuation z-section z-block z-end z-c">}</span></span>
</span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c">
</span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c">    <span class="z-keyword z-control z-c">if</span> <span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-begin z-c">(</span>thirtyEighthCharPassword <span class="z-keyword z-operator z-comparison z-c">!=</span> <span class="z-string z-quoted z-single z-c"><span class="z-punctuation z-definition z-string z-begin z-c">&#39;</span>n<span class="z-punctuation z-definition z-string z-end z-c">&#39;</span></span><span class="z-punctuation z-section z-group z-end z-c">)</span></span> <span class="z-meta z-block z-c"><span class="z-punctuation z-section z-block z-begin z-c">{</span>
</span></span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c"><span class="z-meta z-block z-c">        <span class="z-meta z-function-call z-c"><span class="z-support z-function z-C99 z-c">longjmp</span><span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-begin z-c">(</span></span></span><span class="z-meta z-function-call z-c"><span class="z-meta z-group z-c"><span class="z-keyword z-operator z-c">&amp;</span>mainEnv<span class="z-punctuation z-separator z-c">,</span> <span class="z-constant z-numeric z-integer z-decimal z-c">101</span></span></span><span class="z-meta z-function-call z-c"><span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-end z-c">)</span></span></span><span class="z-punctuation z-terminator z-c">;</span>
</span></span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c"><span class="z-meta z-block z-c">    <span class="z-punctuation z-section z-block z-end z-c">}</span></span>
</span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c">    <span class="z-meta z-function-call z-c"><span class="z-support z-function z-C99 z-c">longjmp</span><span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-begin z-c">(</span></span></span><span class="z-meta z-function-call z-c"><span class="z-meta z-group z-c"><span class="z-keyword z-operator z-c">&amp;</span>mainEnv<span class="z-punctuation z-separator z-c">,</span> <span class="z-constant z-numeric z-integer z-decimal z-c">38</span></span></span><span class="z-meta z-function-call z-c"><span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-end z-c">)</span></span></span><span class="z-punctuation z-terminator z-c">;</span>
</span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c"></span></span><span class="z-meta z-function z-c"><span class="z-meta z-block z-c"><span class="z-punctuation z-section z-block z-end z-c">}</span></span></span>
</span></code></pre>
<p>This function checks if <code>thirtyEighthCharPassword</code> is equal to the character
<code>n</code>. Depending on the result, it jumps to the <code>main</code> function context either
with a value of <code>101</code>, which indicates an error, or a value of <code>38</code>, which is
the offset of the context for the next character check from the
<code>checkFirstCharEnv</code> context.</p>
<p>Note that this function isn't entirely executed the first time it gets called,
since <code>jmp_result</code> is then equal to <code>0</code>. The first execution only sets up the
context in the global variable <code>checkThirtyEighthCharPasswordEnv</code>.</p>
<p>I won't show you the 43 functions, but they're all like these ones. They all set
up jumps values the first time they're executed, and jump to the main function
with different values the second time.</p>
<h1 id="putting-everything-together">Putting everything together</h1>
<p>When we give a password as an argument to this program, it's stored in an array
of characters indexed with global variable names. The program then calls 43
functions, which set up an array of context values indexed with global variable
names too, containing return points.</p>
<p>Then, the <code>main</code> function jumps to the addresses of these functions with the
value <code>1</code>. This is when the characters of the user input are actually checked.
If they don't match, a value of <code>101</code> is returned. If they do match, the array
context index of the next check to perform is returned. This process is repeated
until it reaches the return value of <code>100</code>, indicating a success.</p>
<p>Therefore, we can reconstruct the flag by checking the comparison performed by
each of these functions!</p>
<p>It takes a bit of time, but we end up with the flag
<code>HTB{jump1ng_thru_th3_sp4c3_t1m3_c0nt1nuum!}</code>.</p>
<p>If we run the binary once again with this string as the argument, we receive the
message <code>Looks good to me!</code>!</p>
<h1 id="afterwords">Afterwords</h1>
<p><img src="https://mmezirard.github.io/htb-write-ups/challenges/teleport/success.png" alt="Success" /></p>
<p>That's it for this box! 🎉</p>
<p>I rated this challenge as 'Easy'. The decompiled code was really close to the
reality, but not so easy to understand due the complex control flow. It was also
really annoying to retrieve the characters of the flag one by one.</p>
<p>Thanks for reading!</p>
</section>
</article>

    </main>

        <footer></footer>

    </body>
</html>
